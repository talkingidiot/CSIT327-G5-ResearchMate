{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consultant Verification</title>
  <link rel="stylesheet" href="{% static 'ConsultApp/verification.css'%}">
  <style>
    .expertise-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    
    .expertise-option {
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }
    
    .expertise-option:hover {
      border-color: #4CAF50;
      background: #f1f8f4;
    }
    
    .expertise-option.selected {
      border-color: #4CAF50;
      background: #4CAF50;
      color: white;
    }
    
    .expertise-option input[type="checkbox"] {
      display: none;
    }
    
    .error-message {
      color: #dc2626;
      font-size: 13px;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <nav class="top-nav">
    <div class="logo">ResearchMate</div>
    
    <div class="nav-links">
      <a href="{% url 'consultant_dashboard' %}">ğŸ  Dashboard</a>
      <a href="{% url 'consultant_profile' %}">ğŸ‘¤ My Profile</a>
      <a href="{% url 'consultant_students' %}">ğŸ§‘â€ğŸ“ Students</a>
      <a href="{% url 'consultant_appointments' %}">ğŸ“… Appointments</a>
      <a href="{% url 'consultant_history' %}">ğŸ“œ History</a>
    </div>

    <div class="user-section">
      <span class="consultant-label">Consultant</span>
      <form method="POST" action="{% url 'logout' %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="logout-btn">ğŸšª Logout</button>
      </form>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    {% if messages %}
      <div class="alert">
        {% for message in messages %}
          <p>{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Page Header -->
    <div class="page-header">
      <div class="badge">ğŸ“ Consultant Access</div>
      <h1>Consultant Verification</h1>
      <p>Fill in your details to be verified and available for bookings</p>
    </div>

    <!-- Info Box -->
    <div class="info-box">
      <h4>â„¹ï¸ Verification Process</h4>
      <p>Your application will be reviewed by our admin team within 2-3 business days. You'll receive an email notification once your verification is approved.</p>
    </div>

    <!-- Form Card -->
    <div class="form-card">
      <h2>ğŸ“‹ Verification Form</h2>
      
      <form id="verificationForm" method="POST" action="{% url 'consultant_verification' %}" enctype="multipart/form-data">
        {% csrf_token %}
        
        <!-- Personal Information -->
        <div class="form-section">
          <h3>ğŸ‘¤ Personal Information</h3>
          
          <div class="form-group">
            <label for="fullName">Full Name *</label>
            <input type="text" id="fullName" name="fullName" placeholder="Enter your full name" 
                   pattern="[A-Za-z\s\-]+" title="Only letters, spaces, and hyphens allowed" required>
          </div>

          <div class="form-group">
            <label for="contact">Contact Number (Philippine) *</label>
            <input type="tel" id="contact" name="contact" placeholder="09123456789" 
                   pattern="09[0-9]{9}" maxlength="11" title="Must be 11 digits starting with 09" required>
            <p class="file-hint">Format: 09XXXXXXXXX (11 digits)</p>
          </div>
        </div>

        <!-- Professional Information -->
        <div class="form-section">
          <h3>ğŸ’¼ Professional Information</h3>
          
          <div class="form-group">
            <label>Expertise / Specialization * (Select all that apply)</label>
            <div class="expertise-grid" id="expertiseGrid">
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Research Methodology">
                <span>ğŸ“Š Research Methodology</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Data Analysis">
                <span>ğŸ“ˆ Data Analysis</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Statistical Analysis">
                <span>ğŸ“‰ Statistical Analysis</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Qualitative Research">
                <span>ğŸ’¬ Qualitative Research</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Quantitative Research">
                <span>ğŸ”¢ Quantitative Research</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Machine Learning">
                <span>ğŸ¤– Machine Learning</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Artificial Intelligence">
                <span>ğŸ§  Artificial Intelligence</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Web Development">
                <span>ğŸŒ Web Development</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Mobile Development">
                <span>ğŸ“± Mobile Development</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Database Design">
                <span>ğŸ—„ï¸ Database Design</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Cybersecurity">
                <span>ğŸ”’ Cybersecurity</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Network Administration">
                <span>ğŸŒ Network Administration</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="UI/UX Design">
                <span>ğŸ¨ UI/UX Design</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="System Analysis">
                <span>âš™ï¸ System Analysis</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Software Engineering">
                <span>ğŸ’» Software Engineering</span>
              </label>
              <label class="expertise-option">
                <input type="checkbox" name="expertise" value="Thesis Writing">
                <span>âœï¸ Thesis Writing</span>
              </label>
            </div>
            <p class="error-message" id="expertiseError" style="display: none;">Please select at least one expertise</p>
          </div>

          <div class="form-group">
            <label for="workplace">Workplace *</label>
            <input type="text" id="workplace" name="workplace" placeholder="Your current workplace"
                   pattern="[A-Za-z0-9\s\-\.]+" title="Only letters, numbers, spaces, hyphens, and periods allowed" required>
          </div>

          <div class="form-group">
            <label for="qualification">Qualification *</label>
            <input type="text" id="qualification" name="qualification" placeholder="Your degree or certification"
                   pattern="[A-Za-z0-9\s\-\.,]+" title="Only letters, numbers, spaces, hyphens, periods, and commas allowed" required>
          </div>

          <div class="form-group">
            <label for="bio">Short Bio</label>
            <textarea id="bio" name="bio" placeholder="Introduce yourself and your experience..." maxlength="500"></textarea>
            <p class="file-hint">Tell us about your background and what makes you a great consultant (max 500 characters)</p>
          </div>
        </div>

        <!-- Document Upload (Single file, but shows 3 options) -->
        <div class="form-section">
          <h3>ğŸ“„ Required Document</h3>
          <p style="color: #666; margin-bottom: 15px;">Upload one of the following documents for verification:</p>
          
          <div class="form-group">
            <label for="validId">Upload Valid ID</label>
            <input type="file" id="validId" name="validId" accept="image/jpeg,image/jpg,image/png,.pdf">
            <p class="file-hint">Government-issued ID (Driver's License, Passport, etc.) - JPG, PNG, or PDF</p>
          </div>

          <div class="form-group">
            <label for="license">OR Upload Professional License</label>
            <input type="file" id="license" name="license" accept="image/jpeg,image/jpg,image/png,.pdf">
            <p class="file-hint">Professional license or certification - JPG, PNG, or PDF</p>
          </div>

          <div class="form-group">
            <label for="profilePhoto">OR Upload Profile Photo with ID</label>
            <input type="file" id="profilePhoto" name="profilePhoto" accept="image/jpeg,image/jpg,image/png">
            <p class="file-hint">Professional photo holding your ID (JPG or PNG, max 5MB)</p>
          </div>
          
          <p class="error-message" id="fileError" style="display: none;">Please upload at least one document</p>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="submit" id="submitVerification" class="btn-submit">
            âœ“ Submit Verification Request
          </button>
          <button type="button" class="btn-cancel" onclick="window.location.href='{% url 'consultant_dashboard' %}'">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </main>

  <script>
    // Toggle expertise selection
    document.querySelectorAll('.expertise-option').forEach(option => {
      option.addEventListener('click', function() {
        const checkbox = this.querySelector('input[type="checkbox"]');
        checkbox.checked = !checkbox.checked;
        this.classList.toggle('selected', checkbox.checked);
      });
    });

    // Form validation
    document.getElementById('verificationForm').addEventListener('submit', function(e) {
      let hasError = false;
      
      // Check expertise
      const expertiseChecked = document.querySelectorAll('input[name="expertise"]:checked').length;
      const errorMsg = document.getElementById('expertiseError');
      
      if (expertiseChecked === 0) {
        e.preventDefault();
        errorMsg.style.display = 'block';
        document.getElementById('expertiseGrid').scrollIntoView({ behavior: 'smooth' });
        hasError = true;
      } else {
        errorMsg.style.display = 'none';
      }

      // Check if at least one file is uploaded
      const validId = document.getElementById('validId').files.length;
      const license = document.getElementById('license').files.length;
      const profilePhoto = document.getElementById('profilePhoto').files.length;
      const fileError = document.getElementById('fileError');
      
      if (validId === 0 && license === 0 && profilePhoto === 0) {
        e.preventDefault();
        fileError.style.display = 'block';
        hasError = true;
      } else {
        fileError.style.display = 'none';
      }

      if (hasError) return false;

      // Validate file sizes
      const files = ['validId', 'license', 'profilePhoto'];
      for (let fileId of files) {
        const fileInput = document.getElementById(fileId);
        if (fileInput.files.length > 0) {
          const fileSize = fileInput.files[0].size / 1024 / 1024; // in MB
          if (fileSize > 5) {
            e.preventDefault();
            alert(`File size must be less than 5MB`);
            return false;
          }
        }
      }
    });

    // Contact number formatting
    document.getElementById('contact').addEventListener('input', function(e) {
      this.value = this.value.replace(/[^0-9]/g, '');
    });
  </script>
</body>
</html>
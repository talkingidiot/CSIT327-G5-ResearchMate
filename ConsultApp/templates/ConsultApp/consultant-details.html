{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ consultant.user.get_full_name }} - Consultant Details</title>
  <link rel="stylesheet" href="{% static 'ConsultApp/student-dashboard.css' %}">
  <style>
    .details-container {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
    }
    .back-button {
      display: inline-block;
      padding: 10px 20px;
      background: #f0f0f0;
      color: #333;
      text-decoration: none;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .consultant-header {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }
    .consultant-name {
      font-size: 28px;
      margin: 0 0 10px 0;
      color: #333;
    }
    .consultant-profession {
      color: #666;
      font-size: 18px;
      margin-bottom: 20px;
    }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
      margin-top: 20px;
    }
    .info-item {
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    .info-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }
    .info-value {
      font-size: 16px;
      color: #333;
      font-weight: 500;
    }
    .feedback-section {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 24px;
    }
    .feedback-title {
      font-size: 20px;
      margin: 0 0 20px 0;
      color: #333;
    }
    .rating-summary {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 24px;
    }
    .big-rating {
      font-size: 48px;
      font-weight: 700;
      color: #ffc107;
    }
    .rating-stars {
      color: #ffc107;
      font-size: 24px;
    }
    .feedback-item {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
    }
    .feedback-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    .student-name {
      font-weight: 600;
      color: #333;
    }
    .stars {
      color: #ffc107;
    }
    .feedback-date {
      font-size: 12px;
      color: #999;
      margin-bottom: 8px;
    }
    .feedback-comment {
      color: #555;
      font-style: italic;
      line-height: 1.6;
    }
    .no-reviews {
      text-align: center;
      padding: 40px;
      color: #999;
    }
    .book-button {
      display: inline-block;
      padding: 14px 32px;
      background: #4caf50;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 16px;
    }
    .book-button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>
  <nav class="top-nav">
    <div class="logo">ResearchMate</div>
    <div class="nav-links">
      <a href="{% url 'student_dashboard' %}">üè† Dashboard</a>
      <a href="{% url 'student_profile' %}">üë§ Profile</a>
      <a href="{% url 'student_appointments' %}">üìÖ Appointments</a>
      <a href="{% url 'student_history' %}">üìú History</a>
    </div>
    <div class="user-section">
      <span class="student-label">Student</span>
      <form method="POST" action="{% url 'logout' %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="logout-btn">üö™ Logout</button>
      </form>
    </div>
  </nav>

  <div class="details-container">
    <a href="{% url 'student_dashboard' %}" class="back-button">‚Üê Back to Dashboard</a>

    <div class="consultant-header">
      <h1 class="consultant-name">{{ consultant.user.get_full_name }}</h1>
      <p class="consultant-profession">{{ market.profession }}</p>
      
      <div class="info-grid">
        <div class="info-item">
          <div class="info-label">‚≠ê Expertise</div>
          <div class="info-value">{{ market.expertise }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">üìç Meeting Place</div>
          <div class="info-value">{{ market.meeting_place }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">üí∞ Hourly Rate</div>
          <div class="info-value">‚Ç±{{ market.rate_per_hour }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">üïê Available Hours</div>
          <div class="info-value">{{ market.available_from|time:"g:i A" }} - {{ market.available_to|time:"g:i A" }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">üìÖ Available Days</div>
          <div class="info-value">
            {% if market.available_days %}
              {% for day in market.available_days.split %}
                {{ day|title }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            {% else %}
              Not specified
            {% endif %}
          </div>
        </div>
        <div class="info-item">
          <div class="info-label">üìù About</div>
          <div class="info-value">{{ market.description|default:"No description provided." }}</div>
        </div>
      </div>

      <div style="margin-top: 24px; text-align: center;">
        <a href="{% url 'book_appointment_with_consultant' consultant.user.id %}" class="book-button">
          üìÖ Book Consultation Now
        </a>
      </div>
    </div>

    <div class="feedback-section">
      <h2 class="feedback-title">üìã Student Reviews</h2>
      
      {% if feedbacks %}
        <div class="rating-summary">
          <div class="big-rating">{{ average_rating|floatformat:1 }}</div>
          <div>
            <div class="rating-stars">
              {% for i in "12345" %}
                {% if forloop.counter <= average_rating|floatformat:0|add:"0" %}‚òÖ{% else %}‚òÜ{% endif %}
              {% endfor %}
            </div>
            <div style="color: #666; margin-top: 4px;">
              Based on {{ feedbacks|length }} review{{ feedbacks|length|pluralize }}
            </div>
          </div>
        </div>

        {% for feedback in feedbacks %}
          <div class="feedback-item">
            <div class="feedback-header">
              <span class="student-name">{{ feedback.student.user.get_full_name }}</span>
              <span class="stars">
                {% for i in "12345" %}
                  {% if forloop.counter <= feedback.rating %}‚òÖ{% else %}‚òÜ{% endif %}
                {% endfor %}
              </span>
            </div>
            <div class="feedback-date">{{ feedback.created_at|date:"F d, Y" }}</div>
            {% if feedback.comment %}
              <div class="feedback-comment">"{{ feedback.comment }}"</div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <div class="no-reviews">
          <p><strong>No reviews yet</strong></p>
          <p>Be the first to book and review this consultant!</p>
        </div>
      {% endif %}
    </div>
  </div>
</body>
</html>
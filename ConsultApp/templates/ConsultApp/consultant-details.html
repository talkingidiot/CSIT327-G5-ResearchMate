{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ consultant.user.get_full_name }} - Consultant Details</title>
  <link rel="stylesheet" href="{% static 'ConsultApp/consultant-details.css' %}">
</head>
<body>
  <nav class="top-nav">
    <div class="logo">ResearchMate</div>
    <div class="nav-links">
      <a href="{% url 'student_dashboard' %}">ğŸ  Dashboard</a>
      <a href="{% url 'student_profile' %}">ğŸ‘¤ Profile</a>
      <a href="{% url 'student_appointments' %}">ğŸ“… Appointments</a>
      <a href="{% url 'student_history' %}">ğŸ“œ History</a>
    </div>
    <div class="user-section">
      <span class="student-label">Student</span>
      <form method="POST" action="{% url 'logout' %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="logout-btn">ğŸšª Logout</button>
      </form>
    </div>
  </nav>

  <div class="details-container">
    <a href="{% url 'student_dashboard' %}" class="back-button">â† Back to Dashboard</a>

    <div class="consultant-header">
      <h1 class="consultant-name">{{ consultant.user.get_full_name }}</h1>
      <p class="consultant-profession">{{ market.profession }}</p>
      
      <div class="info-grid">
        <div class="info-item">
          <div class="info-label">â­ Expertise</div>
          <div class="info-value">{{ market.expertise }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">ğŸ“ Meeting Place</div>
          <div class="info-value">{{ market.meeting_place }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">ğŸ’° Hourly Rate</div>
          <div class="info-value">â‚±{{ market.rate_per_hour }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">ğŸ• Available Hours</div>
          <div class="info-value">{{ market.available_from|time:"g:i A" }} - {{ market.available_to|time:"g:i A" }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">ğŸ“… Available Days</div>
          <div class="info-value">
            {% if market.available_days %}
              {% for day in market.available_days.split %}
                {{ day|title }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            {% else %}
              Not specified
            {% endif %}
          </div>
        </div>
        <div class="info-item">
          <div class="info-label">ğŸ“ About</div>
          <div class="info-value">{{ market.description|default:"No description provided." }}</div>
        </div>
      </div>

      <div style="margin-top: 24px; text-align: center;">
        <a href="{% url 'book_appointment_with_consultant' consultant.user.id %}" class="book-button">
          ğŸ“… Book Consultation Now
        </a>
      </div>
    </div>

    <div class="feedback-section">
      <h2 class="feedback-title">ğŸ“‹ Student Reviews</h2>
      
      {% if feedbacks %}
        <div class="rating-summary">
          <div class="big-rating">{{ average_rating|floatformat:1 }}</div>
          <div>
            <div class="rating-stars">
              {% for i in "12345" %}
                {% if forloop.counter <= average_rating|floatformat:0|add:"0" %}â˜…{% else %}â˜†{% endif %}
              {% endfor %}
            </div>
            <div style="color: #666; margin-top: 4px;">
              Based on {{ feedbacks|length }} review{{ feedbacks|length|pluralize }}
            </div>
          </div>
        </div>

        {% for feedback in feedbacks %}
          <div class="feedback-item">
            <div class="feedback-header">
              <span class="student-name">{{ feedback.student.user.get_full_name }}</span>
              <span class="stars">
                {% for i in "12345" %}
                  {% if forloop.counter <= feedback.rating %}â˜…{% else %}â˜†{% endif %}
                {% endfor %}
              </span>
            </div>
            <div class="feedback-date">{{ feedback.created_at|date:"F d, Y" }}</div>
            {% if feedback.comment %}
              <div class="feedback-comment">"{{ feedback.comment }}"</div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <div class="no-reviews">
          <p><strong>No reviews yet</strong></p>
          <p>Be the first to book and review this consultant!</p>
        </div>
      {% endif %}
    </div>
  </div>
</body>
</html>